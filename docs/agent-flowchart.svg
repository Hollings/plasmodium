<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 900">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#58a6ff"/>
    </marker>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.3"/>
    </filter>
  </defs>

  <style>
    .box { fill: #161b22; stroke: #30363d; stroke-width: 2; rx: 8; filter: url(#shadow); }
    .box-start { fill: #238636; stroke: #2ea043; }
    .box-end { fill: #da3633; stroke: #f85149; }
    .box-decision { fill: #1f6feb; stroke: #58a6ff; }
    .box-action { fill: #161b22; stroke: #30363d; }
    .box-work { fill: #9e6a03; stroke: #d29922; }
    .text { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; fill: #c9d1d9; font-size: 14px; text-anchor: middle; }
    .text-small { font-size: 12px; fill: #8b949e; }
    .text-bold { font-weight: 600; fill: #f0f6fc; }
    .arrow { stroke: #58a6ff; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
    .label { font-size: 11px; fill: #3fb950; font-weight: 500; }
    .label-no { fill: #f85149; }
  </style>

  <!-- Background -->
  <rect width="800" height="900" fill="#0d1117"/>

  <!-- Title -->
  <text x="400" y="40" class="text text-bold" font-size="20">Plasmodium Agent Workflow</text>

  <!-- START -->
  <rect x="325" y="70" width="150" height="50" class="box box-start" rx="25"/>
  <text x="400" y="100" class="text text-bold">Agent Spawned</text>

  <!-- Arrow to Read Chat -->
  <path d="M400 120 L400 160" class="arrow"/>

  <!-- Read Chat -->
  <rect x="300" y="160" width="200" height="50" class="box box-action"/>
  <text x="400" y="190" class="text">pm chat</text>
  <text x="400" y="205" class="text text-small">Read phase messages</text>

  <!-- Arrow to Phase Check -->
  <path d="M400 210 L400 250" class="arrow"/>

  <!-- Phase Closed? Diamond -->
  <polygon points="400,250 480,295 400,340 320,295" class="box box-decision"/>
  <text x="400" y="295" class="text text-small">Phase</text>
  <text x="400" y="310" class="text text-small">closed?</text>

  <!-- Yes arrow to Exit -->
  <path d="M480 295 L560 295 L560 100 L510 100" class="arrow"/>
  <text x="510" y="285" class="label">Yes</text>

  <!-- EXIT -->
  <rect x="510" y="75" width="100" height="50" class="box box-end" rx="25"/>
  <text x="560" y="105" class="text text-bold">Exit</text>

  <!-- No arrow to Role Check -->
  <path d="M400 340 L400 380" class="arrow"/>
  <text x="415" y="365" class="label label-no">No</text>

  <!-- Role Decision Diamond -->
  <polygon points="400,380 500,435 400,490 300,435" class="box box-decision"/>
  <text x="400" y="430" class="text text-small">Your</text>
  <text x="400" y="445" class="text text-small">perspective?</text>

  <!-- Discusser path (left) -->
  <path d="M300 435 L180 435 L180 545" class="arrow"/>
  <text x="225" y="425" class="label">Discusser</text>

  <!-- Say Message Box -->
  <rect x="100" y="545" width="160" height="50" class="box box-action"/>
  <text x="180" y="575" class="text">pm say "..."</text>
  <text x="180" y="590" class="text text-small">Share perspective</text>

  <!-- Arrow back up from Say -->
  <path d="M180 595 L180 650 L60 650 L60 185 L300 185" class="arrow"/>

  <!-- Implementer path (right) -->
  <path d="M500 435 L620 435 L620 500" class="arrow"/>
  <text x="545" y="425" class="label">Implementer</text>

  <!-- Discuss Plan -->
  <rect x="540" y="500" width="160" height="50" class="box box-action"/>
  <text x="620" y="530" class="text">pm say "plan..."</text>
  <text x="620" y="545" class="text text-small">Discuss before coding</text>

  <!-- Arrow to Claim Work -->
  <path d="M620 550 L620 590" class="arrow"/>

  <!-- Claim Work -->
  <rect x="540" y="590" width="160" height="50" class="box box-work"/>
  <text x="620" y="620" class="text">pm work "..."</text>
  <text x="620" y="635" class="text text-small">Claim work item</text>

  <!-- Arrow to Do Work -->
  <path d="M620 640 L620 680" class="arrow"/>

  <!-- Do the Work -->
  <rect x="540" y="680" width="160" height="50" class="box box-action"/>
  <text x="620" y="710" class="text">Build / Code</text>
  <text x="620" y="725" class="text text-small">Actually do the work</text>

  <!-- Arrow to Complete -->
  <path d="M620 730 L620 770" class="arrow"/>

  <!-- Complete Work -->
  <rect x="540" y="770" width="160" height="50" class="box box-work"/>
  <text x="620" y="800" class="text">pm work-done "..."</text>
  <text x="620" y="815" class="text text-small">Mark complete</text>

  <!-- Arrow back up from work-done -->
  <path d="M620 820 L620 860 L740 860 L740 185 L500 185" class="arrow"/>

  <!-- Legend -->
  <rect x="50" y="750" width="200" height="130" fill="#161b22" stroke="#30363d" rx="8"/>
  <text x="150" y="775" class="text text-bold" font-size="12">Legend</text>

  <rect x="65" y="790" width="20" height="15" class="box box-start" rx="4"/>
  <text x="95" y="802" class="text text-small" text-anchor="start">Start/End</text>

  <rect x="65" y="815" width="20" height="15" class="box box-decision" rx="2"/>
  <text x="95" y="827" class="text text-small" text-anchor="start">Decision</text>

  <rect x="65" y="840" width="20" height="15" class="box box-action" rx="4"/>
  <text x="95" y="852" class="text text-small" text-anchor="start">Action</text>

  <rect x="65" y="865" width="20" height="15" class="box box-work" rx="4"/>
  <text x="95" y="877" class="text text-small" text-anchor="start">Work Item</text>
</svg>
